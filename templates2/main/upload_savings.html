{% extends 'base/base.html' %}

{% block content %}
<div class="container mt-1 col-md-8">
    <h2 class="mb-4">Upload Monthly Savings</h2>

    <!-- Progress Bar -->
    <div id="progress-container" class="my-3" style="display: none;">
        <label>Uploading...</label>
        <div class="progress">
            <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated"
                 role="progressbar" style="width: 0%">0%</div>
        </div>
    </div>

    <form id="uploadForm" method="POST" enctype="multipart/form-data" class="border p-4 shadow-sm bg-light">
        {% csrf_token %}
        <div class="mb-3">
            <label for="month" class="form-label">Select Month</label>
            <input type="month" id="month" name="month" class="form-control" required>
        </div>
        <div class="mb-3">
            <label for="excel_file" class="form-label">Upload Excel File</label>
            <input type="file" id="excel_file" name="excel_file" class="form-control" accept=".xlsx, .xls" required>
        </div>
        <button type="submit" class="btn btn-primary">Upload</button>
    </form>
</div>

<!-- <script>
    const form = document.getElementById('uploadForm');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');

    form.addEventListener('submit', function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        const xhr = new XMLHttpRequest();
        xhr.open('POST', '', true);

        xhr.upload.addEventListener('loadstart', function () {
            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';
            progressBar.textContent = '0%';
        });

        xhr.upload.addEventListener('progress', function (e) {
            if (e.lengthComputable) {
                const percent = Math.round((e.loaded / e.total) * 100);
                progressBar.style.width = percent + '%';
                progressBar.textContent = percent + '%';
            }
        });

        xhr.onload = function () {
            if (xhr.status === 200) {
                progressBar.classList.remove('progress-bar-animated');
                progressBar.classList.add('bg-success');
                progressBar.textContent = 'Upload Complete!';
                // Optional redirect or success message
                setTimeout(() => window.location.reload(), 1000);
            } else {
                progressBar.classList.add('bg-danger');
                progressBar.textContent = 'Upload Failed!';
            }
        };

        xhr.send(formData);
    });
</script> -->
{% endblock content %}

<!-- <div class="container mt-1 col-md-8">
        <h2 class="mb-4">Upload Monthly Savings</h2>
    
        <form method="POST" enctype="multipart/form-data" class="border p-4 shadow-sm bg-light">
            {% csrf_token %}
            <div class="mb-3">
                <label for="month" class="form-label">Select Month</label>
                <input type="month" id="month" name="month" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="excel_file" class="form-label">Upload Excel File</label>
                <input type="file" id="excel_file" name="excel_file" class="form-control" accept=".xlsx, .xls" required>
            </div>
            <button type="submit" class="btn btn-primary">Upload</button>
        </form>
       
    </div>
    </div>
     -->

   